<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proxy-WASM Runner</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header>
      <h1>Proxy-WASM Runner (Basic)</h1>
      <p>Load a WASM module and trigger hooks manually.</p>
    </header>

    <main>
      <section class="card">
        <h2>Load WASM</h2>
        <input type="file" id="wasmFile" accept=".wasm" />
        <button id="loadBtn">Load</button>
        <div id="loadStatus" class="status"></div>
      </section>

      <section class="grid">
        <div class="card">
          <h2>Request</h2>
          <label>Method</label>
          <select id="reqMethod">
            <option value="GET">GET</option>
            <option value="POST">POST</option>
            <option value="PUT">PUT</option>
            <option value="DELETE">DELETE</option>
            <option value="HEAD">HEAD</option>
            <option value="OPTIONS">OPTIONS</option>
            <option value="PATCH">PATCH</option>
          </select>
          <label>Path</label>
          <input type="text" id="reqPath" value="/" />
          <label>Scheme</label>
          <select id="reqScheme">
            <option value="https">https</option>
            <option value="http">http</option>
          </select>
          <label>Headers (JSON)</label>
          <textarea id="reqHeaders" rows="6">{"host":"example.com"}</textarea>
          <label>Body</label>
          <textarea id="reqBody" rows="6"></textarea>
        </div>
        <div class="card">
          <h2>Response</h2>
          <label>Status Code</label>
          <input type="number" id="resStatus" value="200" min="100" max="599" />
          <label>Status Text</label>
          <input type="text" id="resStatusText" value="OK" />
          <label>Headers (JSON)</label>
          <textarea id="resHeaders" rows="6">
{"content-type":"text/plain"}</textarea
          >
          <label>Body</label>
          <textarea id="resBody" rows="6"></textarea>
        </div>
        <div class="card">
          <h2>Properties (JSON)</h2>
          <textarea id="properties" rows="12">
{"fastedge.trace_id":"demo","root_id":"httpheaders"}</textarea
          >
        </div>
      </section>

      <section class="card">
        <h2>Hooks</h2>
        <div style="margin-bottom: 1rem">
          <label for="logLevel">Log Level Filter:</label>
          <select id="logLevel">
            <option value="0">Trace (show all)</option>
            <option value="1">Debug</option>
            <option value="2" selected>Info</option>
            <option value="3">Warn</option>
            <option value="4">Error</option>
            <option value="5">Critical</option>
          </select>
          <small style="color: #888; display: block; margin-top: 0.25rem">
            Only logs at or above this level will be shown
          </small>
        </div>
        <div class="hook-buttons">
          <button id="runAllBtn" class="primary">â–¶ Run All Hooks</button>
          <button data-hook="onRequestHeaders">onRequestHeaders</button>
          <button data-hook="onRequestBody">onRequestBody</button>
          <button data-hook="onResponseHeaders">onResponseHeaders</button>
          <button data-hook="onResponseBody">onResponseBody</button>
        </div>
      </section>

      <section class="card">
        <h2>Output</h2>
        <pre id="output"></pre>
      </section>
    </main>

    <script src="/app.js"></script>
  </body>
</html>
